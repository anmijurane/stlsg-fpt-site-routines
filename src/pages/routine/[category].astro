---
import MainLayout from "@layouts/MainLayout.astro";

import ExpandableCardGroup from "@components/expandibleCompose/ExpandableCardGroup.astro";
import ExpandableCardDay from "@components/expandibleCompose/ExpandableCardDay.astro";
import HeaderRoutineDays from "@components/global/HeaderRoutineDays.astro";

import { routines } from "@data/index";
import ProgressRoutine from "@components/ProgressRoutine.astro";
import Heating from "@components/ExerciseCards/Heating.astro";
import Cooling from "@components/ExerciseCards/Cooling.astro";
import GeneralCard from "@components/ExerciseCards/GeneralCard.astro";
import type { TypeRoutine } from "@interfaces/routines";

const { category } = Astro.params;
const categoryType = category as TypeRoutine;
const params = new URL(Astro.url).searchParams;
const level = Number(params.get("level"));

const isValid = Object.keys(routines).includes(categoryType);
const { levels, name: nameRoutine, id: idRoutine } = routines[categoryType];

console.log({ length: levels.length });

const currentLevel = levels.find((it) => it.id === level);

if (!isValid || !currentLevel) {
  return Astro.redirect("/404");
}

const { id, days } = currentLevel;
---

<MainLayout title="Rutina dinamica Nivel 1" themeColor="#290241">
  <div
    class="flex flex-col w-full sm:w-8/12 md:w-6/12 lg:w-5/12 xl:w-5/12 shadow-2xl rounded-md"
  >
    <HeaderRoutineDays id={idRoutine} level={id} title={nameRoutine} />
    <ExpandableCardGroup
      name={`level_${id}`}
      class="flex justify-center items-center flex-col gap-8 py-12 text-theme-primary bg-theme"
    >
      {
        days.map((day) => {
          if (["Descanso", "Mixto"].includes(day.focus)) {
            return (
              <ExpandableCardDay
                day={day.id}
                id={`${day.id}`}
                title={day.focus}
              >
                <div class="flex flex-col gap-8 items-center bg-white p-8 rounded-b-2xl">
                  <svg
                    width="80"
                    height="77"
                    viewBox="0 0 80 77"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M20.4835 7.24404C23.3646 1.23079 27.1805 -1.01978 32.1019 0.416135C34.2007 1.02587 36.0091 2.36816 37.1967 4.19761C38.3843 6.02707 38.8717 8.22146 38.5697 10.3796C37.8406 15.4141 34.1834 18.0808 27.6215 18.198C27.8038 18.6727 27.9332 19.0947 28.1272 19.4815C30.5967 24.2757 33.0838 29.064 35.5475 33.8582C35.9928 34.8087 36.7123 35.6052 37.6141 36.146C38.5159 36.6867 39.5589 36.9472 40.61 36.8941H60.8188C62.4533 36.8941 63.3 36.2612 63.3647 35.0538C63.4294 33.8465 62.6709 33.0611 60.9187 32.9556C55.2388 32.6157 49.559 32.2699 43.8673 32.0296C43.2344 32.0517 42.6095 31.8835 42.0737 31.547C41.5379 31.2104 41.116 30.7211 40.8628 30.1424C39.3928 27.3351 37.7935 24.598 36.2472 21.8317C35.7768 20.9877 35.5416 20.1438 36.4294 19.4112C37.3173 18.6786 38.1934 19.0126 38.8695 20.1731C40.2336 22.5526 41.6036 24.9321 42.856 27.3702C43.0698 27.8834 43.4366 28.3187 43.9066 28.6175C44.3766 28.9162 44.9273 29.0639 45.4843 29.0406C50.6056 29.2516 55.721 29.5505 60.8305 29.867C64.9464 30.119 66.5809 31.9417 66.3928 36.0502C66.3928 36.2377 66.3928 36.4253 66.4339 36.9C67.9744 36.9 69.5149 36.8707 71.0496 36.9C73.2904 36.893 75.4423 37.7736 77.0318 39.3481C78.6213 40.9226 79.5182 43.062 79.5253 45.2957C79.5323 47.5293 78.6488 49.6743 77.0692 51.2587C75.4897 52.8431 73.3434 53.7371 71.1025 53.7441C67.9274 53.7969 64.7464 53.7441 61.5655 53.7441C60.4954 53.7441 59.5958 53.5097 59.6075 52.2554C59.6193 51.0012 60.5012 50.714 61.5714 50.7199C64.5112 50.7199 67.4511 50.7199 70.391 50.7199C73.8483 50.7199 76.2708 48.4576 76.2708 45.3396C76.2708 42.2217 73.8601 39.9535 70.391 39.9476C60.6188 39.9476 50.8408 39.9007 41.0686 39.9476C36.9527 39.9769 34.1951 38.1894 32.3724 34.5322C28.8974 27.5519 25.3167 20.6302 21.683 13.7144C19.2546 9.0609 14.5743 7.47261 9.72937 9.55907C8.62968 10.0017 7.56615 10.5288 6.54841 11.1356C5.29588 11.9713 4.36752 13.2086 3.91729 14.6423C3.46706 16.0761 3.52201 17.6202 4.07302 19.0185C4.17488 19.3477 4.34101 19.6536 4.56187 19.9185C4.78272 20.1835 5.05394 20.4023 5.35994 20.5625C5.66593 20.7226 6.00066 20.8209 6.34488 20.8516C6.6891 20.8823 7.03602 20.845 7.3657 20.7416C8.20062 20.5541 9.01791 20.3079 9.85284 20.1555C13.1926 19.4581 15.4739 20.5775 16.8498 23.7131C19.384 29.4684 21.8593 35.2472 24.3524 41.0202C25.5871 43.8861 26.8336 46.7462 28.0272 49.6298C28.143 49.9917 28.3837 50.3011 28.7067 50.5028C29.0297 50.7046 29.4139 50.7856 29.7912 50.7316C33.3484 50.6965 36.9057 50.7316 40.463 50.7316C40.9378 50.7179 41.413 50.7335 41.8859 50.7785C42.0903 50.7789 42.2923 50.8222 42.4788 50.9057C42.6652 50.9892 42.8319 51.111 42.9678 51.2632C43.1038 51.4153 43.206 51.5943 43.2678 51.7885C43.3296 51.9828 43.3496 52.1878 43.3264 52.3903C43.3269 52.5825 43.2865 52.7726 43.2079 52.9481C43.1292 53.1236 43.0142 53.2805 42.8703 53.4084C42.7264 53.5363 42.5569 53.6324 42.373 53.6903C42.1892 53.7481 41.9951 53.7665 41.8036 53.7441H30.2439C29.5795 53.7441 29.0209 53.8027 29.0268 54.7053C29.0268 61.035 29.0268 67.3647 29.0268 73.8117C29.5325 73.8527 29.944 73.9172 30.3497 73.9172H70.6321C72.4783 73.9172 72.4725 73.9172 72.4725 72.0183C72.4725 67.5718 72.4725 63.1273 72.4725 58.6848C72.4725 58.2628 72.3607 57.7295 72.5724 57.4423C72.9252 56.9676 73.4897 56.3522 73.9718 56.3522C74.4539 56.3522 75.0596 56.9383 75.4006 57.4071C75.6358 57.7354 75.5299 58.3214 75.5299 58.7903C75.5299 64.0377 75.5299 69.2852 75.5299 74.5326C75.5299 76.578 75.1419 76.9824 73.1486 76.9824H28.3153C26.3985 76.9824 25.9634 76.5429 25.9634 74.6381C25.9634 67.7867 25.9634 60.9354 25.9634 54.0782C25.9541 53.0941 25.7545 52.121 25.3755 51.2122C21.7182 42.6495 18.0022 34.1044 14.3038 25.5592C13.1926 22.9863 12.4987 22.6288 9.79405 23.3087C9.10023 23.4786 8.41818 23.6896 7.72436 23.8361C6.48536 24.1066 5.1909 23.9487 4.05388 23.3884C2.91686 22.8282 2.00501 21.8988 1.46828 20.7533C-0.295652 17.0727 0.409916 12.3195 3.50268 9.67043C6.71892 6.91583 10.4996 5.20445 14.8506 5.67332C16.7145 5.89017 18.5314 6.68725 20.4835 7.24404ZM29.4795 3.14143C28.6958 3.14909 27.9213 3.31056 27.2001 3.61661C26.479 3.92266 25.8254 4.3673 25.2767 4.92514C24.728 5.48299 24.2948 6.14311 24.0021 6.86781C23.7093 7.59251 23.5626 8.3676 23.5704 9.14882C23.5774 10.3291 23.9359 11.4808 24.6004 12.4578C25.2648 13.4348 26.2054 14.1932 27.3027 14.6368C28.4001 15.0804 29.6048 15.1892 30.7643 14.9495C31.9238 14.7098 32.9858 14.1324 33.8157 13.2904C34.6455 12.4484 35.2059 11.3797 35.4258 10.2199C35.6456 9.06006 35.515 7.86127 35.0506 6.7755C34.5862 5.68972 33.8088 4.76583 32.817 4.12096C31.8252 3.47608 30.6636 3.13925 29.4795 3.15316V3.14143Z"
                      fill="#9600FA"
                    />
                  </svg>
                  <h1>Seguimos trabajando en este día</h1>
                </div>
              </ExpandableCardDay>
            );
          }

          if (day.focus === "Cardio") {
            return (
              <ExpandableCardDay
                day={day.id}
                id={`${day.id}`}
                title={day.focus}
              >
                <div class="flex flex-col gap-8 items-center bg-white p-8 rounded-b-2xl">
                  <svg
                    width="80"
                    height="77"
                    viewBox="0 0 80 77"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M20.4835 7.24404C23.3646 1.23079 27.1805 -1.01978 32.1019 0.416135C34.2007 1.02587 36.0091 2.36816 37.1967 4.19761C38.3843 6.02707 38.8717 8.22146 38.5697 10.3796C37.8406 15.4141 34.1834 18.0808 27.6215 18.198C27.8038 18.6727 27.9332 19.0947 28.1272 19.4815C30.5967 24.2757 33.0838 29.064 35.5475 33.8582C35.9928 34.8087 36.7123 35.6052 37.6141 36.146C38.5159 36.6867 39.5589 36.9472 40.61 36.8941H60.8188C62.4533 36.8941 63.3 36.2612 63.3647 35.0538C63.4294 33.8465 62.6709 33.0611 60.9187 32.9556C55.2388 32.6157 49.559 32.2699 43.8673 32.0296C43.2344 32.0517 42.6095 31.8835 42.0737 31.547C41.5379 31.2104 41.116 30.7211 40.8628 30.1424C39.3928 27.3351 37.7935 24.598 36.2472 21.8317C35.7768 20.9877 35.5416 20.1438 36.4294 19.4112C37.3173 18.6786 38.1934 19.0126 38.8695 20.1731C40.2336 22.5526 41.6036 24.9321 42.856 27.3702C43.0698 27.8834 43.4366 28.3187 43.9066 28.6175C44.3766 28.9162 44.9273 29.0639 45.4843 29.0406C50.6056 29.2516 55.721 29.5505 60.8305 29.867C64.9464 30.119 66.5809 31.9417 66.3928 36.0502C66.3928 36.2377 66.3928 36.4253 66.4339 36.9C67.9744 36.9 69.5149 36.8707 71.0496 36.9C73.2904 36.893 75.4423 37.7736 77.0318 39.3481C78.6213 40.9226 79.5182 43.062 79.5253 45.2957C79.5323 47.5293 78.6488 49.6743 77.0692 51.2587C75.4897 52.8431 73.3434 53.7371 71.1025 53.7441C67.9274 53.7969 64.7464 53.7441 61.5655 53.7441C60.4954 53.7441 59.5958 53.5097 59.6075 52.2554C59.6193 51.0012 60.5012 50.714 61.5714 50.7199C64.5112 50.7199 67.4511 50.7199 70.391 50.7199C73.8483 50.7199 76.2708 48.4576 76.2708 45.3396C76.2708 42.2217 73.8601 39.9535 70.391 39.9476C60.6188 39.9476 50.8408 39.9007 41.0686 39.9476C36.9527 39.9769 34.1951 38.1894 32.3724 34.5322C28.8974 27.5519 25.3167 20.6302 21.683 13.7144C19.2546 9.0609 14.5743 7.47261 9.72937 9.55907C8.62968 10.0017 7.56615 10.5288 6.54841 11.1356C5.29588 11.9713 4.36752 13.2086 3.91729 14.6423C3.46706 16.0761 3.52201 17.6202 4.07302 19.0185C4.17488 19.3477 4.34101 19.6536 4.56187 19.9185C4.78272 20.1835 5.05394 20.4023 5.35994 20.5625C5.66593 20.7226 6.00066 20.8209 6.34488 20.8516C6.6891 20.8823 7.03602 20.845 7.3657 20.7416C8.20062 20.5541 9.01791 20.3079 9.85284 20.1555C13.1926 19.4581 15.4739 20.5775 16.8498 23.7131C19.384 29.4684 21.8593 35.2472 24.3524 41.0202C25.5871 43.8861 26.8336 46.7462 28.0272 49.6298C28.143 49.9917 28.3837 50.3011 28.7067 50.5028C29.0297 50.7046 29.4139 50.7856 29.7912 50.7316C33.3484 50.6965 36.9057 50.7316 40.463 50.7316C40.9378 50.7179 41.413 50.7335 41.8859 50.7785C42.0903 50.7789 42.2923 50.8222 42.4788 50.9057C42.6652 50.9892 42.8319 51.111 42.9678 51.2632C43.1038 51.4153 43.206 51.5943 43.2678 51.7885C43.3296 51.9828 43.3496 52.1878 43.3264 52.3903C43.3269 52.5825 43.2865 52.7726 43.2079 52.9481C43.1292 53.1236 43.0142 53.2805 42.8703 53.4084C42.7264 53.5363 42.5569 53.6324 42.373 53.6903C42.1892 53.7481 41.9951 53.7665 41.8036 53.7441H30.2439C29.5795 53.7441 29.0209 53.8027 29.0268 54.7053C29.0268 61.035 29.0268 67.3647 29.0268 73.8117C29.5325 73.8527 29.944 73.9172 30.3497 73.9172H70.6321C72.4783 73.9172 72.4725 73.9172 72.4725 72.0183C72.4725 67.5718 72.4725 63.1273 72.4725 58.6848C72.4725 58.2628 72.3607 57.7295 72.5724 57.4423C72.9252 56.9676 73.4897 56.3522 73.9718 56.3522C74.4539 56.3522 75.0596 56.9383 75.4006 57.4071C75.6358 57.7354 75.5299 58.3214 75.5299 58.7903C75.5299 64.0377 75.5299 69.2852 75.5299 74.5326C75.5299 76.578 75.1419 76.9824 73.1486 76.9824H28.3153C26.3985 76.9824 25.9634 76.5429 25.9634 74.6381C25.9634 67.7867 25.9634 60.9354 25.9634 54.0782C25.9541 53.0941 25.7545 52.121 25.3755 51.2122C21.7182 42.6495 18.0022 34.1044 14.3038 25.5592C13.1926 22.9863 12.4987 22.6288 9.79405 23.3087C9.10023 23.4786 8.41818 23.6896 7.72436 23.8361C6.48536 24.1066 5.1909 23.9487 4.05388 23.3884C2.91686 22.8282 2.00501 21.8988 1.46828 20.7533C-0.295652 17.0727 0.409916 12.3195 3.50268 9.67043C6.71892 6.91583 10.4996 5.20445 14.8506 5.67332C16.7145 5.89017 18.5314 6.68725 20.4835 7.24404ZM29.4795 3.14143C28.6958 3.14909 27.9213 3.31056 27.2001 3.61661C26.479 3.92266 25.8254 4.3673 25.2767 4.92514C24.728 5.48299 24.2948 6.14311 24.0021 6.86781C23.7093 7.59251 23.5626 8.3676 23.5704 9.14882C23.5774 10.3291 23.9359 11.4808 24.6004 12.4578C25.2648 13.4348 26.2054 14.1932 27.3027 14.6368C28.4001 15.0804 29.6048 15.1892 30.7643 14.9495C31.9238 14.7098 32.9858 14.1324 33.8157 13.2904C34.6455 12.4484 35.2059 11.3797 35.4258 10.2199C35.6456 9.06006 35.515 7.86127 35.0506 6.7755C34.5862 5.68972 33.8088 4.76583 32.817 4.12096C31.8252 3.47608 30.6636 3.13925 29.4795 3.15316V3.14143Z"
                      fill="#9600FA"
                    />
                  </svg>
                  <h1>Seguimos trabajando en el día de descanso</h1>
                </div>
              </ExpandableCardDay>
            );
          }

          return (
            <ExpandableCardDay day={day.id} id={`${day.id}`} title={day.focus}>
              <div class="flex flex-col gap-8 items-center bg-white p-8 rounded-b-2xl">
                <ProgressRoutine />
                <Heating />
                {day.exercises.map((it) => {
                  return (
                    <GeneralCard
                      title={it.name}
                      zone={it.zone}
                      rep={it?.reps || 0}
                      series={it?.series || 0}
                      img={it.muscle.imgUrl}
                    />
                  );
                })}
                <Cooling />
              </div>
            </ExpandableCardDay>
          );
        })
      }
    </ExpandableCardGroup>
  </div>
</MainLayout>
