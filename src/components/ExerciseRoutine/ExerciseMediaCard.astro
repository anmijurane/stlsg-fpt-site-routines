---
import { Image } from "astro:assets";
import play from "@assets/icons/play.png";

interface Props {
  imgUrl: string;
  videoUrl: string;
  alt: string;
}
const { imgUrl, videoUrl, alt } = Astro.props;
---

<div
  class="relative w-11/12 mx-auto bg-white rounded-2xl shadow-lg overflow-visible p-6 flex justify-center items-center"
  id="container"
>
  <img
    src={imgUrl}
    id="thumbnail"
    alt={alt}
    class="block w-full h-auto object-cover -mt-6 -mb-6"
  />

  <video
    id="player"
    src={videoUrl}
    controls
    class="hidden absolute inset-0 w-full h-full object-cover rounded-2xl"
  >
    Tu navegador no soporta este video.
  </video>

  <button
    id="play-button"
    class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10
      flex items-center justify-center active:animate-ping
      w-30 h-30 rounded-full bg-white/20 backdrop-blur-[1px]"
  >
    <Image src={play} alt="Boton de play" class="size-15" />
  </button>
</div>

<script>
  const __init__ = () => {
    const poster = document.getElementById("thumbnail") as HTMLImageElement;
    const player = document.getElementById("player") as HTMLVideoElement;
    const playBtn = document.getElementById("play-button") as HTMLButtonElement;
    const container = document.getElementById("container") as HTMLDivElement;

    if (!poster || !player || !playBtn) return;

    playBtn.addEventListener("click", () => {
      poster.classList.add("opacity-0");
      playBtn.classList.add("hidden");

      player.classList.remove("hidden");
      player.currentTime = 0;
      player.play();
    });
  };
  document.addEventListener("astro:page-load", __init__);
</script>
