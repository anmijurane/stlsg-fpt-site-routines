---
import closeIcon from "@assets/icons/close.png";
import { Image } from "astro:assets";

interface Props {
  id: string;
  btnClose?: boolean;
}
const { id, btnClose = true } = Astro.props;
console.log(`create a modal for id : ${id}`);

const script_set = `(()=> {
  const dialog = document.getElementById("${id}");
  const handleOnCloseModal = () => {
    dialog.classList.add('closing');
    setTimeout(() => dialog.close(), 250);
    dialog.classList.remove('closing');
  }
  if (dialog && !dialog.hasAttribute("data-init")) {
    dialog.setAttribute("data-init", "true");
    document.addEventListener("open-dialog-${id}", () => dialog.showModal());
    document.addEventListener("close-dialog-${id}", () => handleOnCloseModal);
    dialog.addEventListener("click", (e) => {
      if (e.target === dialog) handleOnCloseModal();
    });
  }
})()`;
---

<div id={id}>
  <div
    class="relative z-10 ease-out duration-300"
    aria-labelledby="dialog-title"
    role="dialog"
    aria-modal="true"
  >
    <div
      class="fixed inset-0 bg-theme-secondary/75 transition-opacity"
      aria-hidden="true"
    >
    </div>

    <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
      <div class="flex min-h-full items-center justify-center p-4 text-center">
        <div
          class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"
        >
          <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
            <div class="sm:flex sm:items-start">
              <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                <h3 class="text-3xl font-semibold text-theme-primary">
                  ¡Cuéntanos tu experiencia!
                </h3>
                <div class="mt-2">
                  <p class="text-sm text-gray-500">
                    En esta primer etapa nos gustaria saber como te ha parecido.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script is:inline set:html={script_set} />

<style>
  /* dialog {
    align-self: center;
    justify-self: center;
    border: none;
    border-radius: 20px;
    transition: 0.3s ease;
    background: transparent;
    position: fixed;
    inset: 0;
    margin: auto;
  } */
  dialog::backdrop {
    background-color: #290241ba;
    backdrop-filter: blur(3px);
    transition: backdrop-filter 0.3s ease;
  }
  dialog[open] {
    animation: dialogFadeIn 0.4s ease-out;
  }

  dialog.closing {
    animation: dialogFadeOut 0.3s ease-in forwards;
  }

  .float__button--dialog img {
    border: none;
  }

  .float__button--dialog {
    width: 50px;
    height: 50px;
    position: fixed;
    top: 40px;
    right: 40px;
    border-radius: 50%;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.25));
    transition:
      opacity 0.2s ease 0.4s,
      transform 0.3s ease 0.4s;
  }

  @media (max-width: 800px) {
    .float__button--dialog {
      top: 25px;
      right: 25px;
    }
  }
  @media (max-width: 440px) {
    .float__button--dialog {
      top: 15px;
      right: 15px;
    }
  }

  @keyframes dialogFadeIn {
    from {
      opacity: 0;
      transform: translateY(-2rem) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  @keyframes dialogFadeOut {
    from {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    to {
      opacity: 0;
      transform: translateY(-1rem) scale(0.95);
    }
  }
</style>
